@use "../styles/utils/variables" as *;
@use "../styles/utils/mixins" as *;

.sidebar {
	grid-area: 1 / 1 / 2 / 2;
	margin: $spacing-sm;
	width: 72px;
	height: calc(100vh - 1rem);
	display: grid;
	grid-template-rows: 56px 1fr auto 1fr auto;
	padding: $spacing-md $spacing-sm;
	@include glass-subtle; // Apply subtle glass effect always
	border-radius: $border-radius-2xl;
	overflow: hidden;
	z-index: 1000;
	@include transition(all, $transition-speed-medium, $ease-out-expo);

	&:hover {
		width: 280px;
		@include glass-medium; // Enhance on hover
		box-shadow: $glass-shadow-high;
	}

	&__list {
		width: 100%;
		overflow: hidden;
		margin: 0;
		padding: 0;
	}

	&__item {
		width: 256px;
		height: 3rem;
		margin-bottom: 2px;
		padding: $spacing-sm;
		border-radius: $border-radius-lg;
		cursor: pointer;
		@include transition(all, $transition-speed-fast, $ease-out-expo);

		&:hover {
			background: rgba(255, 255, 255, 0.08);
			backdrop-filter: blur($backdrop-blur-subtle);
			-webkit-backdrop-filter: blur($backdrop-blur-subtle);
			border: 1px solid rgba(255, 255, 255, 0.08);
		}

		&:active {
			transform: scale(0.98);
		}
	}
	
	&__link {
		display: flex;
		align-items: center;
		gap: 1.5rem;
		width: 100%;
		height: 100%;
		color: var(--text-secondary);
		text-decoration: none;
		font-weight: $font-weight-medium;
		border-radius: $border-radius-sm;
		border: none;
		background: transparent;
		cursor: pointer;
		@include transition(all);

		svg {
			margin: 2px;
		}

		span {
			display: inline-block;
		}
	}

	&__user {
		margin-top: auto;
		padding: $spacing-sm;
		display: flex;
		align-items: center;
		flex-direction: column;
		gap: $spacing-xs;
		border-top: 1px solid var(--border-color);
	}

	&__user-info {
		display: none;
		flex-direction: column;
		gap: 2px;
		min-width: 0;
	}

	&__user-name {
		font-size: $font-size-sm;
		font-weight: $font-weight-medium;
		color: var(--text-primary);
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
	}

	&__user-email {
		font-size: $font-size-xs;
		color: var(--text-secondary);
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
	}

	&__user-greeting {
		display: inline-flex;
		align-items: center;
		gap: $spacing-xs;
		margin-right: $spacing-md;
		color: $gray-700;
		font-weight: $font-weight-medium;
	}

	&__action {
		@include glass-button;
		padding: $spacing-sm;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: $spacing-xs;
		width: calc(100% - 2 * $spacing-xs);
		color: var(--text-primary);
		cursor: pointer;
		font-weight: $font-weight-medium;
	}

	// Base UI Dialog backdrop with glass overlay
	&__modal-backdrop {
		position: fixed;
		inset: 0;
		z-index: $z-index-modal-backdrop;
		@include glass-overlay;
		animation: fade-in $transition-speed-medium $ease-out-expo;
	}

	// Base UI Dialog popup container
	&__modal-popup {
		position: fixed;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		z-index: $z-index-modal;
		width: 90vw;
		max-width: 600px;
		max-height: 90vh;
		overflow-y: auto;
		animation: modal-slide-up $transition-speed-medium $ease-out-expo;

		// Custom scrollbar for modal
		&::-webkit-scrollbar {
			width: 8px;
		}

		&::-webkit-scrollbar-track {
			background: transparent;
		}

		&::-webkit-scrollbar-thumb {
			background: rgba(255, 255, 255, 0.2);
			border-radius: $border-radius-full;

			&:hover {
				background: rgba(255, 255, 255, 0.3);
			}
		}
	}

	// Modal content with glass effect
	&__modal-content {
		@include glass-strong;
		border-radius: $border-radius-2xl;
		padding: $spacing-xl;
		color: var(--text-primary);
		display: flex;
		flex-direction: column;
		gap: $spacing-lg;
	}

	// Modal title
	&__modal-title {
		font-size: $font-size-xxl;
		font-weight: $font-weight-bold;
		color: var(--text-primary);
		margin: 0;
	}

	&__form {
		display: flex;
		flex-direction: column;
		gap: $spacing-md;
	}

	&__field {
		display: flex;
		flex-direction: column;
		gap: $spacing-xs;
	}

	&__field-label {
		font-weight: $font-weight-medium;
		color: var(--text-primary);
		font-size: $font-size-sm;
	}

	&__field-input {
		padding: $spacing-sm $spacing-md;
		border: 1px solid rgba(255, 255, 255, 0.1);
		border-radius: $border-radius-lg;
		background: rgba(var(--glass-bg-rgb), 0.15);
		backdrop-filter: blur($backdrop-blur-subtle);
		-webkit-backdrop-filter: blur($backdrop-blur-subtle);
		color: var(--text-primary);
		font-size: $font-size-base;
		@include transition(all, $transition-speed-fast, $ease-out-expo);

		&:focus {
			outline: none;
			border-color: var(--primary-color);
			background: rgba(var(--glass-bg-rgb), 0.25);
			box-shadow: 0 0 0 3px var(--focus-ring);
		}

		&::placeholder {
			color: var(--text-secondary);
		}

		&:disabled {
			opacity: 0.6;
			cursor: not-allowed;
		}
	}

	&__field-error {
		color: var(--danger-color);
		font-size: $font-size-xs;
		margin-top: 2px;
	}

	&__form-actions {
		display: flex;
		justify-content: flex-end;
		gap: $spacing-sm;
		margin-top: $spacing-sm;
	}

	&__radio-group {
		border: 1px solid rgba(255, 255, 255, 0.08);
		border-radius: $border-radius-lg;
		padding: $spacing-md;
		background: rgba(var(--glass-bg-rgb), 0.1);
		display: flex;
		flex-direction: column;
		gap: $spacing-sm;

		legend {
			font-weight: $font-weight-semibold;
			margin-bottom: $spacing-xs;
			color: var(--text-primary);
		}
	}

	&__radio-option {
		display: grid;
		grid-template-columns: auto 1fr;
		grid-template-rows: auto auto;
		column-gap: $spacing-sm;
		row-gap: 2px;
		align-items: center;
		padding: $spacing-md;
		border-radius: $border-radius-lg;
		cursor: pointer;
		border: 1px solid transparent;
		background: rgba(var(--glass-bg-rgb), 0.05);
		@include transition(all, $transition-speed-fast, $ease-out-expo);

		&:hover {
			background: rgba(var(--glass-bg-rgb), 0.15);
			border-color: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur($backdrop-blur-subtle);
			-webkit-backdrop-filter: blur($backdrop-blur-subtle);
		}

		input {
			grid-row: 1 / span 2;
		}

		input:checked ~ &-label {
			color: var(--primary-color);
		}
	}

	&__radio-label {
		font-weight: $font-weight-medium;
		color: var(--text-primary);
	}

	&__radio-hint {
		font-size: $font-size-xs;
		color: var(--text-secondary);
		grid-column: 2;
	}
}

// Animations for modal
@keyframes fade-in {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}

@keyframes modal-slide-up {
	from {
		opacity: 0;
		transform: translate(-50%, -45%) scale(0.95);
	}
	to {
		opacity: 1;
		transform: translate(-50%, -50%) scale(1);
	}
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
	.sidebar__modal-backdrop,
	.sidebar__modal-popup {
		animation: none;
	}
}
